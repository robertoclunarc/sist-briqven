SELECT DISTINCT   E.TRABAJADOR TRABAJADOR,   RTRIM(LTRIM(SUBSTR(E.NOMBRE,1,22))) NOMBRE,   E.CENTRO_COSTO CENTRO_COSTO,   E.RELACION_LABORAL RELACION_LABORAL,   E.TIPO_NOMINA TIPO_NOMINA,   E.UBICGEO UBICGEO,   TO_CHAR(E.RATA_HORA, '99999999999.99') RATA_HORA,   TO_CHAR(E.SUELDO_MENSUAL,'9999999999.99') SUELDO_MENSUAL,   E.INSTITUCION_DEPOSITO INSTITUCION_DEPOSITO,   E.CUENTA_DEPOSITO CUENTA_DEPOSITO,   E.PERIODO ,   E.FECHA,   E.NRO_CORRELATIVO,   E.DIRECCION,   E.GERENCIA,   E.COD_GER,   E.COD_SUP,   E.COD_GER_GRAL,   E.OFICINA,   T.E_MAIL,    E.TIPO_NOMINA || ' ' || TO_CHAR(E.PERIODO,'00') || ' ' || TO_CHAR(FECHA, 'YYYY') || '-' || E.RELACION_LABORAL  REFERENCIA,   'ATTACHMENT/' || LTRIM(RTRIM(SUBSTR(T.E_MAIL, 1, INSTR(T.E_MAIL,'@', 1) -1))) || '-LAME072017.PDF' PDF,   LTRIM(RTRIM(SUBSTR(T.E_MAIL, 1, INSTR(T.E_MAIL,'@', 1) -1))) SIGLADO   ,PWD.DATO AS PWD   ,TO_CHAR(SYSDATE, 'DDMMYYYYHH24MISS') FECHA_HOY   ,G.FECHA_INGRESO FROM      ENC_LAME072017  E    , TRABAJADORES   T   , DET_LAME072017 D   , TP_COMP_CORREO_SID PWD   , TRABAJADORES_GRALES G WHERE  T.TRABAJADOR = E.TRABAJADOR   AND E.TRABAJADOR = D.TRABAJADOR   AND E.TRABAJADOR = PWD.TRABAJADOR   AND T.TRABAJADOR = PWD.TRABAJADOR   AND D.TRABAJADOR = PWD.TRABAJADOR   AND D.TRABAJADOR = T.TRABAJADOR   AND D.TRABAJADOR = T.TRABAJADOR   AND D.TRABAJADOR = G.TRABAJADOR   and (instr(ltrim(rtrim(t.e_mail)),'.com') = 0   and instr(ltrim(rtrim(t.e_mail)),'briqven') = 0 )  and TO_NUMBER(t.trabajador)  IN (25393124)

 SELECT REF.CONCEPTO, NRO_DIAS_HORAS, CANTIDAD, REF.DESCRIPCION, decode(rtrim(ltrim(to_char(saldo,'999,999,990.00'))),'0.00','',to_char(saldo,'999,999,990.00')) as SALDO, decode(rtrim(ltrim(to_char(decode(d.tipo_concepto,1,monto_asig,decode(d.tipo_concepto, 1, MONTO_ASIG, 0)),'999,999,990.00'))),'0.00','',to_char(decode(d.tipo_concepto,1,monto_asig,decode(d.tipo_concepto, 1, monto_asig, 0)),'999,999,990.00')) ASIG,  decode(rtrim(ltrim(to_char(monto_aporte,'999,999,990.00'))),'0.00','',to_char(monto_aporte,'999,999,990.00')) APORTE,  decode(rtrim(ltrim(to_char(decode(d.tipo_concepto,3, monto_asig,0),'999,999,990.00'))),'0.00','',to_char(decode(d.tipo_concepto,3, monto_asig,0),'999,999,990.00')) DEDUC_LEY,  decode(rtrim(ltrim(to_char(decode(d.tipo_concepto,4, monto_asig,0),'999,999,990.00'))),'0.00','',to_char(decode(d.tipo_concepto,4, monto_asig,0),'999,999,990.00')) DEDUC_PERSONAL,  TIPO_TRANSACCION, d.INDICADOR_MENSEM, d.TIPO_CONCEPTO FROM  DET_LAME072017 REF, CONCEPTOS C, conceptos_comprobantes_sid d Where  trabajador = '  25393124' and c.concepto = ref.concepto  and c.concepto = d.concepto  Order By d.tipo_concepto,concepto, to_number(decode(length(rtrim(ltrim(cantidad))),0,'0',1,substr(cantidad,1),substr(cantidad,2))) 
